#### 个人介绍

“面试官您好！我是来应聘公司前端开发工程师岗位。

我叫莫荣包，毕业于东南大学地理信息科学专业，拥有超过5年的前端开发经验。在上一份工作中，我除了负责仿真组内仿真前端页面的功能开发和迭代，同时还主导了仿真可视化功能模块的专项性能优化和代码重构工作。我这边主要的技术栈是Vue2 + js，Vue3和小程序在以往的项目中也有过相关经历，但占比不高。小程序的开发，主要用的是uni-app和mpVue框架。

以上就是我的简略个人介绍。

#### 中智行

仿真场景平台是集成了 Prediction、Planning、Perception 和 Control 等模块，对常规与特殊交通 场景进行还原推演，实现 98% 以上真实场景覆盖率，大幅降低自动驾驶的路测成本的智能仿真系统。

  + 可视化模块的专项性能优化

    + S： planning等算法组相关用户反馈可视化页面卡顿问题，严重影响用户体验
    + T： 减少卡顿的出现
    + A： 
      + 排查问题： 针对长卡顿的场景利用Performance调试工具进行录制，并且针对每一帧的任务进行分析
      + 分析指标： 通过Performance选项卡和拉取时间轴就可以查看其网络请求，Js执行时间，页面渲染时间，长任务的原因。
      + 定位问题和代码关联： 最终发现主要几个大的原因：1. 网络数据一次性传输量大 2. playBagDetailData函数内频繁的图层数据的计算和收集 3. 频繁的mapbox图层的add、setData和remove操作。4.一次性大循环同步渲染所有的图层，这些内容大量阻塞渲染进程；
      + 解决方案：（数据层）1. 减少一次性传输的数据，由一次性的50帧减少到5帧数据；由后端进行path的坐标数据进行抽稀，提高传输数据效率。 (计算层)2. 引入webWorker，将CPU密集型计算，类似图层数据的收集，数据的解码，数据的相关计算都移入webWorker内完成，减少由Js线程导致GUI线程的阻塞问题； (渲染层) 3. 对mapbox渲染逻辑进行重构：（1.将同类型数据进行合并，通过filter控制feature的显示，避免每一种数据都是一个图层，过多的图层；（2.初始化的时候将常用的source和Layer新增，后续只需要setData操作；（3.缓存每次新增的Layer和source，避免每次都需要add；（4.通过setLayoutProperty将remove操作修改成 visibility 控制，可以更高效的图层的显示和隐藏；（5. 为每个图层合理设置 minzoom/maxzoom，避免低缩放级别渲染大量要素。 (调度层) 4.将原来一次性大循环同步渲染修改成 --> 利用requestAnimationFrame特性进行切片渲染，让大批量渲染任务分散到多帧执行，极大提升页面流畅度。
    + R： 
      + 用户体验上：卡顿现象大幅度减少；
      + 对Performance重新录制，发现长任务大幅度减少60%，数据传输速率提高了50%。

  + 针对可视化功能相关代码的重构

    + S: 源代码存在性能瓶颈，性能优化需要进行这一块代码的重构，不适合在源代码堆加和修改
    + T: 便于相关性能优化的展开，提高代码的可读性，便于维护
    + A: 
      + 排查问题: 把整个功能模块相关代码进行分析，绘制相关的依赖和架构图
      + 分析和问题定位: 发现 -- 可视化页面功能基本共享一个Vue文件，数据传输，数据计算，map初始化，渲染逻辑等相关逻辑都揉在一起，存在可读性差，难开发迭代，难维护等问题
      + 解决方法: 1. 页面上，根据业务展示的相关模块（进度条，数据展示区，图表等）进行组件化，将大的页面拆分成一个个小的组件构成。2. 逻辑上主要是根据分层解耦的思想：将整个逻辑拆分成数据层，计算层，渲染层和调度层。保证每个模块只负责自己相应的模块，保证其单一性。
    + R: 
      + 大大便于性能优化的工作的展开，更好的排查和优化相关问题
      + 提高了代码的可读性和扩展性

  + 可能遇到的问题

    + **为什么使用PB，使用过程中具体遇到了哪些问题，怎么解决的，需要注意哪些事项？**

      + S: 在自动驾驶行业中，一般涉及到的数据量都是大额数据，比如一条轨迹路径就有上千个坐标点。
      + T: 主要是为了解决前后端之间这些大数据的高频传输问题
      + A: 
        + PB主要是二进制编码，相对于JSON/XML的文件格式，数据体积可以缩减60-80%，对于这类高频传输的仿真数据，可以大大缓解网络带宽的压力。
        + 其次PB对于数据量大的情况下，序列化和反序列化相对比JSON.parse要快的多，而且PB存在强类型schema约束，不仅仅可以通过.proto文件进行类型约束，还可以按需加载相应的数据
        + 同时PB对跨语言很兼容，类似我们前端使用JS和后端使用C++。
      
      + 遇到的问题？
        1. 浏览器端解析瓶颈
          
            虽然使用PB能减少数据传输的体积，但是一次性大规模的轨迹数据解析操作放在客户端，仍可能会阻塞主线程，造成页面卡顿问题。例如：之前每次一次性传输50帧数据，传输、解码和反序列化都需要时间。
            解决方案：引入双线程，将解码和计算过程放在webWorker中，同时减少一次性传输数据的帧数，将原先的50帧改成5帧。

        2. 前端调试困难

          PB是二进制数据流，无法直接阅读，调试时难以定位数据异常

          解决方案：没啥好的思路，只能用土方法，通过console解析后的数据，进行某一帧的数据排查。

        3. 动态数据兼容性

          PB的序列化和反序列化都需要.proto文件维持其准确性，所以需要前端和后端共同维护好Proto文件，保持其一致性。

        4. .proto文件的解析是需要引入protobufjs，使用 protobufjs-cli 预编译 .proto 为最小化的 -minimal.js 文件。

    + **为什么使用webWoker，webWoker的原理是？webWorker的使用过程中可能会遇到的一些问题？怎么解决的？使用过程中需要注意哪些事项？**

      + 什么是 webWoker

        webWoker本质上浏览器新开的一个子线程，类似是浏览器的封装的一个并发模型。因为Worker运行是在一个于主线程相互隔离的全局上下文，因此是不能再Worker中操作DOM。webWoker于其他线程之间的通信主要是靠 ```postMessage``` 和 ```MessageChannel```进行通信的。

      + S: 通过Performance工具拍摄排查性能问题，发现逻辑上存在很多类似PB的解码，mapbox图层数据的收集和计算等重CPU计算任务，严重阻塞了主线程
      + T：通过webWoker，引入双线程，解决阻塞问题
      + A：
        + 将PB的解码，mapbox图层geoJson数据结构的处理和计算等重CPU计算任务放到webWorker中，减轻主线程压力，保证UI的流畅性。

      + 可能存在的问题？

        + ```postMessage``` 传输时开销大？

          ```postMessage```进行通信的时候，所传输的数据是需要克隆对象，存在结构化克隆对象，就会造成CPU占用特别高，特别如果一次性处理的数据还很大的情况下。
          解决方案：1. 一次性传输处理的数据不要太大，不过高频率的传输等。 2. 自定义二进制数据传输，利用Transferable Objects，零拷贝对象传输，减少序列化和反序列化的消耗 3. 共享内存 SharedArrayBuffer。

        + ```postMessage```传输需要进行结构化克隆
          需要注意的是：
            1. Function对象是不能被结构化克隆算法复制的
            2. 克隆 DOM 节点同样会抛出 DATA_CLONE_ERR 异常
            3. RegExp 对象的 lastIndex 字段不会被保留
            4. 属性描述符，setters 以及 getters（以及其他类似元数据的功能）同样不会被复制。例如，如果一个对象用属性描述符标记为 read-only，它将会被复制为 read-write，因为这是默认的情况下。
            5. 原形链上的属性也不会被追踪以及复制。

        + 使用过程中需要注意内存泄漏问题

          Worker 未主动销毁或数据引用未清除 -> Worker 持续持有大数据引用 → 内存不释放 → 页面崩溃；

          任务完成后调用 worker.terminate() 立即销毁线程

    + **什么是RAF，为什么使用RAF，解决了哪些问题，使用过程中可能会遇到哪些问题？怎么解决的呢？**

      + 什么是RAF

        **```requestAnimationFrame```** （简称 RAF）是浏览器提供的用于执行高效动画的 JavaScript API，它能确保动画与屏幕刷新率同步，实现流畅渲染。RAF的回调函数是在下一帧的渲染之前会被执行。

      + 为什么使用RAF

        在项目中发现每次都是同步 for 循环：一次性处理大量渲染任务（渲染所有的图层信息），主线程长时间被占用，UI卡顿，动画掉帧。

        解决方法： 分片渲染：每次只处理一小部分任务，主线程有空闲时间响应用户操作和页面绘制，保证流畅。也就是说将重渲染任务分多次 ```requestAnimationFrame``` 执行，每次只处理一小批（如5~20个）geojson。保证其每次渲染时间不超过16ms，不阻塞主线程，提高其fps

      + 可能遇到的问题

        + 异步渲染导致状态错乱
          问题：分批渲染是异步的，可能和其他 UI 操作（如切换帧、拖动进度条、暂停/重播）产生竞态，导致渲染状态错乱。
          解决：每次开始新一帧渲染前，先取消/中断上一次的分批渲染（如用标志位或取消函数）。

        + 数据变更未及时响应
          问题：用户在分批渲染过程中切换配置、拖动进度条，导致当前渲染的数据已过时，但分批渲染还在继续。
          解决：每次数据变更时，重置分批渲染的 index/标志，保证只渲染最新的数据。

        + 内存泄漏/残留定时器
          问题：分批渲染过程中未正确清理 requestAnimationFrame 或 requestIdleCallback，导致内存泄漏或重复渲染。
          解决：渲染结束或组件销毁时，务必清理所有定时器和回调。

        + 分批渲染粒度不合理
          问题：batchSize 过大，分批效果不明显；batchSize 过小，渲染变慢，用户感知到延迟。
          解决：根据实际性能动态调整 batchSize，或根据帧率自适应。

        + 与动画/进度条冲突
          问题：分批渲染和动画（如进度条、地图飞行）同时进行时，可能出现动画卡顿或进度条不同步。
          解决：动画和分批渲染解耦，动画优先保证流畅，渲染任务分批执行。

    + **怎么实现流式处理的？WebSocket是什么？原理是啥？使用过程中遇到了哪些问题？怎么解决的呢？**

      流式数据传输：主要是数据以连续流的形式从源端传输到接收端
      流式处理：本质上就是大数据集拆分为小块（chunk），分批传输/处理，避免一次性加载导致的阻塞

      WebSocket：是HTML5引入的，就是基于单个TCP连接上实现双向通信的全双工通信协议，它主要是基于HTTP握手建立连接，复用 http 协议，借助 101 响应码实现协议升级，切换到轻量级的二进制帧协议进行全双工数据传输。

      需要注意的问题：
        + 网络波动导致连接中断问题：设置好重连机制和心跳检测
    + **为什么使用了mapbox？怎么深度集成的？遇到了哪些问题？具体都怎么解决的呢？**

      + 技术选型：为什么使用mapbox？

        首先智能驾驶仿真需要毫米级车道渲染和万级动态目标实时交互，而mapbox是个专业地图工具，可以利用矢量瓦片和自定义样式，可以丰富的还原车道级渲染、立交桥多层结构、动态交通要素等场景，实现高精度地图要求。其次针对高频率，高性能要求的渲染场景，mapbox GL也提供了丰富的GL的API，同时也保证了高效的性能。

      + 怎么集成的？

        + 图层体系的构建

          因为我们是依赖于mapbox图层来实现各类渲染的，所以第一步是对各个图层体系的构建，例如：
            + L0	基础道路瓦片层	Mapbox矢量瓦片（mapbox://styles/mapbox/streets-v11）	显示路网、建筑轮廓
            + L1	车道线语义层	line图层 + line-dasharray动态样式	区分虚实线、潮汐车道
            + L2	动态车辆层	symbol图层 + 自定义WebGL Shader绘制车辆朝向	实时显示车辆位置/方向
            + L3	交通信号层	circle图层 + 数据驱动样式（match表达式）	红绿灯状态可视化
            + L4	3D道路结构层	fill-extrusion图层 + 地形高程数据	立交桥、隧道多层立体渲染
            + L5	轨迹预测层	line图层 + 渐变色动画（line-gradient + animate）	车辆未来路径推演
        + 高性能图层的渲染

          + 初始化时统一add，不频繁不进行remove和add操作，只涉及setData
          + 图层缓存操作
          + 避免remove操作，尽量设置其 visibility 控制图层显示和隐藏，实现更高效的控制

          可优化的空间：
          + 抽稀
          + 增量更新机制

        + 遇到的问题： 

          + draw all 的问题 --> 同类型图层合并
          + 频繁add和remove layer --> 图层的缓存机制，初始化创建，visibility控制图层变化
          + 图层设置合理的maxZoom和minZoom
          + 图层遮挡的问题 --> 做好图层层级的分类和设置，设置好beforeId

    + **监控平台是什么？怎么搭建的呢？遇到了哪些问题？怎么解决的？**
          


  参考：
  + [如何提升 JS 代码性能](https://www.yuque.com/u1598738/vqazlv/vrb4gg673bfzmptt)
  + [详解 Vue 性能优化](https://www.yuque.com/u1598738/vqazlv/vr1dgahq69nk118s)

#### 集牛智能运营平台

基于企业微信生态，为保险公司代理人团队提供包括保险专业服务输出、微信多场景展业经营以及产品销售推动的数字化智能系统。主要是利用企业微信这个生态(因为企微是专为企业打造的专业办公管理工具)，目的是为了解决客户难管理、难沟通，难维护的痛点。

  + 企业微信 SDK 的封装

    + S：公司PC端，H5项目都依赖企业微信SDK，所以每个项目都维护来一套SDK的注册逻辑，存在不易维护，重复劳动等问题
    + T：封装一套公用的企微SDK，提高可利用率，减少重复劳动。
    + A：
      + 1.抽取常用和公用的SDK进行模块化设计，按照SDK的功能进行模块划分
      + 2.对SDK响应事件接口，通过Promise封装，完成统一的接口封装
      + 3.暴露出自定义核心配置与初始化，要求项目在入口处一次性传入必要配置（corpId, agentId 等）
      + 4.对错误的统一拦截，进行统一的错误管理
      + 5.打包成npm包，发布到公司私有仓库 
    + R：在后续的SDK维护和开发中，减少了重复工作，提高了开发效率。

  + 设计和实现后台账号菜单权限控制方案

    + S：原有的后管页面无特定的权限控制功能
    + T：解决公司管理页面无特定权限管理的场景
    + A：
      + 通过用户登录信息，获取到role，menus；
      + 前端根据 menus 生成动态路由表 (accessedRoutes):
      + 使用 Vue Router 的 router.addRoute 方法，将 accessedRoutes 逐个添加到现有的路由实例中。
      + 根据路由数据动态渲染菜单，实现基本的菜单权限控制
    + R：
      + 解决后管页面无权限管理的情况
      + 提供了可视化的菜单权限页面，也提高了权限配置的效率

  + 搭建多环境的mook调式工具

    + S：H5项目严重依赖企微和微信生态，导致调试代码比较麻烦，通常很多页面需要打开微信开发者工具进行调试，而不是熟悉的Web页面模拟调试。
    + T：模拟不同环境（企微、微信WebView、小程序），解决调试难问题
    + A：
      + 判断环境，只有在非生产环境下（如开发、测试环境）才会执行调试相关的模拟代码，避免影响正式环境。
      + 通过URL上参数mockDebug字段是否启用本地mook环境
      + 如启用，则根据参数调用setUserAgent方法，动态修改 navigator.userAgent，模拟不同终端（如企业微信、微信开发者工具等）的 userAgent 字符串。
      + 通过setManagerUserInfo，添加相关的用户信息。
      + 最后手动创建window.wx = new QywxEnv()对象，模拟相关的响应事件。
    + R：
      + 通过自定义参数控制，模拟不同环境，解决了强依赖企微，微信环境的调试难问题。


#### 广告智能投放平台

  公司背景：是一个ToB的服务概念，主要是基于 Vue 和 element-ui 等技术，为广告公司提供包括广告选址，大屏广告投放以及广告运营管理等相关功能 的数字化智能系统。



#### 软技能问题

  ##### 通用技术类：

    你最近关注哪些前端新技术/趋势？ (考察学习热情)

    你常用的前端调试工具有哪些？ (考察开发效率)

    如何实现一个前端权限控制系统？（类似你在保险项目做的） (考察设计能力)

    谈谈你对 TypeScript 的理解，它解决了什么问题？ (考察工程化语言)

    如何处理跨域问题？ (考察网络基础)

    前端安全方面需要注意哪些点？如何防范 XSS 和 CSRF？ (考察安全意识)

    你如何管理前端项目的依赖和构建？(Webpack/Vite 等) (考察工程化)

    你平时如何学习提升自己的前端技术？ (考察学习能力)

  ##### 行为与软技能类：

    为什么离开上一家公司？ (回答要正面积极，聚焦个人发展)

    你觉得自己最大的优点和缺点是什么？ (缺点要诚实且体现改进意愿)

    你遇到过的技术难题是什么？是怎么解决的？ (准备一个STAR案例)

    你如何评估一项新技术是否适合引入项目？ (考察技术决策)

    你的职业规划是什么？ (表达对前端方向的持续深入和兴趣)

    你对我们公司/这个岗位有什么了解？为什么想来？ (必须提前调研应聘公司！)

  