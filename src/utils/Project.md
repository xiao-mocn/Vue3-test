#### 中智行

仿真场景平台是集成了 Prediction、Planning、Perception 和 Control 等模块，对常规与特殊交通 场景进行还原推演，实现 98% 以上真实场景覆盖率，大幅降低自动驾驶的路测成本的智能仿真系统。

  + 可视化模块的专项性能优化

    + S： planning等算法组相关用户反馈可视化页面卡顿问题，严重影响用户体验
    + T： 减少卡顿的出现
    + A： 
      + 排查问题： 针对长卡顿的场景利用Performance调试工具进行录制，并且针对每一帧的任务进行分析
      + 分析指标： 通过Performance选项卡和拉取时间轴就可以查看其网络请求，Js执行时间，页面渲染时间，长任务的原因。
      + 定位问题和代码关联： 最终发现主要几个大的原因：1. 网络数据一次性传输量大 2. playBagDetailData函数内频繁的图层数据的计算和收集 3. 频繁的mapbox图层的add和remove操作。4.一次性大循环同步渲染所有的图层，这些内容大量阻塞渲染进程；
      + 解决方案：（数据层）1. 减少一次性传输的数据，由一次性的50帧减少到5帧数据；由后端进行path的坐标数据进行抽稀，提高传输数据效率。 (计算层)2. 引入webWorker，将CPU密集型计算，类似图层数据的收集，数据的解码，数据的相关计算都移入webWorker内完成，减少由Js线程导致GUI线程的阻塞问题； (渲染层) 3. 对mapbox渲染逻辑进行重构：（1.将同类型数据进行合并，通过filter控制feature的显示，避免每一种数据都是一个图层，过多的图层；（2.初始化的时候将常用的source和Layer新增，后续只需要setData操作；（3.缓存每次新增的Layer和source，避免每次都需要add；（4.通过setLayoutProperty将remove操作修改成visibility控制，可以更高效的图层的显示和隐藏；（5. 为每个图层合理设置 minzoom/maxzoom，避免低缩放级别渲染大量要素。 (调度层) 4.将原来一次性大循环同步渲染修改成 --> 利用requestAnimationFrame特性进行切片渲染，让大批量渲染任务分散到多帧执行，极大提升页面流畅度。
    + R： 
      + 用户体验上：卡顿现象大幅度减少；
      + 对Performance重新录制，发现长任务大幅度减少，数据传输消耗也大大降低。

  + 针对可视化功能相关代码的重构

    + S: 源代码存在性能瓶颈，性能优化需要进行这一块代码的重构，不适合在源代码堆加和修改
    + T: 便于相关性能优化的展开，提高代码的可读性，便于维护
    + A: 
      + 排查问题: 把整个功能模块相关代码进行分析，绘制相关的依赖和架构图
      + 分析和问题定位: 发现 -- 可视化页面功能基本共享一个Vue文件，数据传输，数据计算，map初始化，渲染逻辑等相关逻辑都揉在一起，存在可读性差，难开发迭代，难维护等问题
      + 解决方法: 1. 页面上，根据业务展示的相关模块（进度条，数据展示区，图表等）进行组件化，将大的页面拆分成一个个小的组件构成。2. 逻辑上主要是根据分层解耦的思想：将整个逻辑拆分成数据层，计算层，渲染层和调度层。保证每个模块只负责自己相应的模块，保证其单一性。
    + R: 
      + 大大便于性能优化的工作的展开，更好的排查和优化相关问题
      + 提高了代码的可读性和扩展性

  参考：
  + [如何提升 JS 代码性能](https://www.yuque.com/u1598738/vqazlv/vrb4gg673bfzmptt)
  + [详解 Vue 性能优化](https://www.yuque.com/u1598738/vqazlv/vr1dgahq69nk118s)

#### 集牛智能运营平台

基于企业微信生态，为保险公司代理人团队提供包括保险专业服务输出、微信多场景展业经营以及产品销售推动的数字化智能系统。主要是利用企业微信这个生态(因为企微是专为企业打造的专业办公管理工具)，目的是为了解决客户难管理、难沟通，难维护的痛点。

  + 企业微信 SDK 的封装

    + S：公司PC端，H5项目都依赖企业微信SDK，所以每个项目都维护来一套SDK的注册逻辑，存在不易维护，重复劳动等问题
    + T：封装一套公用的企微SDK，提高可利用率，减少重复劳动。
    + A：
      + 1.抽取常用和公用的SDK进行模块化设计，按照SDK的功能进行模块划分
      + 2.对SDK响应事件接口，通过Promise封装，完成统一的接口封装
      + 3.暴露出自定义核心配置与初始化，要求项目在入口处一次性传入必要配置（corpId, agentId 等）
      + 4.对错误的统一拦截，进行统一的错误管理
      + 5.打包成npm包，发布到公司私有仓库 
    + R：在后续的SDK维护和开发中，减少了重复工作，提高了开发效率。

  + 设计和实现后台账号菜单权限控制方案

    + S：原有的后管页面无特定的权限控制功能
    + T：解决公司管理页面无特定权限管理的场景
    + A：
      + 通过用户登录信息，获取到role，menus；
      + 前端根据 menus 生成动态路由表 (accessedRoutes):
      + 使用 Vue Router 的 router.addRoute 方法，将 accessedRoutes 逐个添加到现有的路由实例中。
      + 根据路由数据动态渲染菜单，实现基本的菜单权限控制
    + R：
      + 解决后管页面无权限管理的情况
      + 提供了可视化的菜单权限页面，也提高了权限配置的效率

  + 搭建多环境的mook调式工具

    + S：H5项目严重依赖企微和微信生态，导致调试代码比较麻烦，通常很多页面需要打开微信开发者工具进行调试，而不是熟悉的Web页面模拟调试。
    + T：模拟不同环境（企微、微信WebView、小程序），解决调试难问题
    + A：
      + 判断环境，只有在非生产环境下（如开发、测试环境）才会执行调试相关的模拟代码，避免影响正式环境。
      + 通过URL上参数mockDebug字段是否启用本地mook环境
      + 如启用，则根据参数调用setUserAgent方法，动态修改 navigator.userAgent，模拟不同终端（如企业微信、微信开发者工具等）的 userAgent 字符串。
      + 通过setManagerUserInfo，添加相关的用户信息。
      + 最后手动创建window.wx = new QywxEnv()对象，模拟相关的响应事件。
    + R：
      + 通过自定义参数控制，模拟不同环境，解决了强依赖企微，微信环境的调试难问题。


#### 广告智能投放平台

  公司背景：是一个ToB的服务概念，主要是基于 Vue 和 element-ui 等技术，为广告公司提供包括广告选址，大屏广告投放以及广告运营管理等相关功能 的数字化智能系统。

  